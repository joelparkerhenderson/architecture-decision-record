# AWSのADRプロセス

https://docs.aws.amazon.com/prescriptive-guidance/latest/architectural-decision-records/adr-process.html

ADR（Architectural Decision Record）とは、構築予定のソフトウェアアーキテクチャの重要な側面について、チームが行う選択を記述した文書です。各ADRには、アーキテクチャー決定、そのコンテキスト、およびその結果が記述されます。ADRには状態があるため、ライフサイクルに従います。ADRの例については、付録を参照のこと。

ADR プロセスは、アーキテクチャの決定記録のコレクションを出力します。このコレクションにより、決定ログが作成されます。決定ログは、プロジェクトのコンテキストのほか、詳細な実装および設計情報を提供します。プロジェクトメンバーは、各 ADR の見出しに目を通し、プロジェクトの概要を把握します。そして、ADRを読み、プロジェクトの実装やアーキテクチャの選択について深く掘り下げます。

チームがADRを受け入れると、そのADRは不変のものとなる。新たな洞察により異なる決定が必要になった場合、チームは新しいADRを提案する。チームが新しいADRを受け入れると、それは以前のADRに取って代わります。


## ADRプロセスの範囲

プロジェクトメンバは、ソフトウェアプロジェクトやプロダクトに影響を与える、アーキテクチャ的に重要な決定ごとにADRを作成すべきです。これには以下のRichardsとFordの2020が含まれます。

* 構造（例えば、マイクロサービスなどのパターン）

* 非機能要件（セキュリティ、高可用性、耐障害性）

* 依存関係（コンポーネントの結合）

* インターフェース（APIと公開コントラクト）

* 構築手法（ライブラリ、フレームワーク、ツール、プロセス）

* 機能要件と非機能要件は、ADRプロセスへの最も一般的なインプットである。


## ADRコンテキスト

チームが ADR の必要性を認識すると、チーム メンバーがプロジェクト全体のテンプレートに基づいて ADR の作成を開始します (サンプル テンプレートについては、ADR GitHub organization を参照してください)。テンプレートを使用すると ADR の作成が簡単になり、ADR にすべての関連情報が確実に取り込まれるようになります。各 ADR では少なくとも、決定のコンテキスト、決定自体、プロジェクトとその成果物に対する決定の結果を定義する必要があります (これらのセクションの例については、付録を参照してください)。ADR 構造の最も強力な側面の 1 つは、チームがどのように決定を実装したかではなく、決定の理由に焦点を当てていることです。チームが決定を下した理由を理解することで、他のチーム メンバーがその決定を採用しやすくなり、意思決定プロセスに関与していない他のアーキテクトが将来その決定を覆すことを防ぐことができます。

## ADR導入プロセス

チームメンバーは誰でも ADR を作成できますが、ADR の所有権はチームで明確に定義する必要があります。ADR の所有者である各作成者は、ADR のコンテンツを積極的に維持管理し、共有する必要があります。この所有権を明確にするため、このガイドでは以降のセクションでは ADR 作成者を ADR 所有者（ADR オーナー）と呼びます。他のチームメンバーはいつでも ADR に貢献できます。チームが ADR を承認する前に ADR の内容が変更された場合は、所有者がその変更を承認する必要があります。

チームがアーキテクチャ上の決定とその所有者を特定した後、ADR オーナーはプロセスの開始時に **提案済み** 状態の ADR を提供します。提案済み状態の ADR はレビューの準備が整っています。

ADRオーナーは、ADRのレビュープロセスを開始します。ADRレビュープロセスの目的は、チームがADRを承認するか、修正が必要と判断するか、あるいは却下するかを決定することです。所有者を含むプロジェクトチームがADRをレビューします。レビュー会議は、ADRを読むための専用の時間枠を設けることから始めます。平均10～15分あれば十分です。この時間内に、各チームメンバーはドキュメントを読み、不明な点があればコメントや質問を追加します。レビューフェーズの後、ADRオーナーは各コメントを読み上げ、チームと話し合います。

チームがADRを改善するためのアクションポイントを見つけた場合、ADRの状態は**提案済み**のままとなります。ADRオーナーはアクションを策定し、チームと協力して各アクションに担当者を追加します。各チームメンバーはアクションポイントに貢献し、解決することができます。レビュープロセスのスケジュール変更はADRオーナーの責任です。

チームはADRを拒否することもできます。この場合、ADRオーナーは拒否の理由を追加し、同じトピックに関する将来の議論を回避します。オーナーはADRの状態を「**拒否**」に変更します。

チームがADRを承認する場合、オーナーはタイムスタンプ、バージョン、関係者リストを追加します。その後、オーナーは状態を「**承認**」に更新します。

ADR とそれによって作成される意思決定ログは、チームによる意思決定を表し、すべての意思決定の履歴を提供します。チームは、可能な限り、コードレビューとアーキテクチャレビューの際に ADR を参照資料として使用します。コードレビュー、設計タスク、実装タスクの実行に加えて、チームメンバーは製品の戦略的な意思決定について ADR を参照する必要があります。

グッドプラクティスとして、すべてのソフトウェア変更はピアレビューを受け、少なくとも 1 回の承認を得る必要があります。コードレビュー中に、コードレビュー担当者が 1 つ以上の ADR に違反する変更を発見する場合があります。この場合、レビュー担当者はコード変更の作成者にコードの更新を依頼し、ADR へのリンクを共有します。作成者がコードを更新すると、ピアレビュー担当者によって承認され、メインのコードベースにマージされます。


## ADRレビュープロセス

チームは、ADR を承認または却下した後は、変更不可能なドキュメントとして扱う必要があります。既存の ADR を変更するには、新しい ADR を作成し、新しい ADR のレビュープロセスを確立し、ADR を承認する必要があります。チームが新しい ADR を承認した場合、オーナーは古い ADR の状態を **置換済み** に変更する必要があります。